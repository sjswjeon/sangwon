<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <!-- Reset Css -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reset-css@5.0.1/reset.min.css">
    <!-- Google Material Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet">
    <!-- CSS -->
   <link rel="stylesheet" th:href="@{/css/main.css}">
   <link rel="stylesheet" href="/src/main/resources/static/css/main.css">
   <link rel="stylesheet" th:href="@{/css/board-post.css}">
   <link rel="stylesheet" href="/src/main/resources/static/css/board-post.css">

    <!--  JQuery CDN  -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <!-- Gsap -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.7.1/gsap.min.js" integrity="sha512-UxP+UhJaGRWuMG2YC6LPWYpFQnsSgnor0VUF3BHdD83PS/pOpN+FYbZmrYN+ISX8jnvgVUciqP/fILOXDjZSwg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <!-- JS -->
    <script defer th:src="@{/js/main.js}"></script>
   <script defer src="/src/main/resources/static/js/main.js"></script>
    <script defer th:src="@{/js/board-list.js}"></script>
   <script defer src="/src/main/resources/static/js/board-list.js"></script>
   <script defer th:src="@{/js/board-post.js}"></script>
<!--   <script defer src="/src/main/resources/static/js/board-post.js"></script>-->

</head>
<body>
    <!-- Side Bar -->
    <header th:replace="fragments/common :: side-bar">
        <div class="side-bar">
            <div class="side-bar__inner">

                <div class="side-bar__top-container">
                    <div class="logo"></div>
                    <div class="website-name">SJSWJEON</div>
                    <div class="material-icons" id="side-bar-close-btn">west</div>
                </div>

                <div class="side-bar__bottom-container">
                    <div class="side-bar__container active">
                        <div class="material-icons">home</div>
                        <div class="menu-name">Home</div>
                        <div class="toggle-btn material-icons">arrow_drop_down</div>
                    </div>
                    <div class="side-bar__container">
                        <div class="material-icons">assignment</div>
                        <div class="menu-name">Board</div>
                        <div class="toggle-btn material-icons">arrow_drop_down</div>
                    </div>
                    <div class="side-bar__container">
                        <div class="material-icons">chat_bubble</div>
                        <div class="menu-name">Message</div>
                        <div class="toggle-btn material-icons">arrow_drop_down</div>
                    </div>
                    <div class="side-bar__container">
                        <div class="material-icons">star</div>
                        <div class="menu-name">Rewards</div>
                        <div class="toggle-btn material-icons">arrow_drop_down</div>
                    </div>
                    <div class="side-bar__container">
                        <div class="material-icons">account_circle</div>
                        <div class="menu-name">My Page</div>
                        <div class="toggle-btn material-icons">arrow_drop_down</div>
                    </div>
                    <div class="side-bar__container">
                        <div class="material-icons">people</div>
                        <div class="menu-name">Members</div>
                        <div class="toggle-btn material-icons">arrow_drop_down</div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Top Header -->
    <header th:replace="fragments/common :: top-header">
        <div class="top-header">
            <div class="top-header__top-container">
                <div class="website-name">SJSWJEON</div>
            </div>
            <div class="top-header__bottom-container">
                <div class="left-box">
                    <div class="website-name">SJSWJEON</div>
                    <div class="website-name__add">CREATIVITY</div>
                </div>
                <div class="right-box">
                    <div class="material-icons">stars</div>
                    <div class="material-icons">stars</div>
                    <div class="material-icons">stars</div>
                    <div class="material-icons">stars</div>
                </div>
            </div>
        </div>
    </header>

    <!-- Top nav bar -->
    <nav th:replace="fragments/common :: top-navbar">
        <div class="nav-inner">
            <div class="nav__left-container">
                <div class="nav__menu" id="nav-menu-btn">
                    <div class="material-icons">menu</div>
                    <div class="left-container__name">Menu</div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main container -->
    <div class="main-container">
        <div class="inner">
            <div class="left-box">
                <div class="left-box__text">
                    <span style="font-weight: bold; font-size: 40px;">Hello!<br><span>USER01234</span></span>
                    <span>|</span>
                    <div>Type what you want to say to the world,<br>The world is your oyster :)</div>
                </div>
                <div class="left-box__menu">
                    <div class="write-btn">Write</div>
                    <div>My Posts</div>
                    <div class="search">
                        <div class="material-icons">search</div>
                        <input type="text">
                    </div>
                </div>
            </div>
            <div class="right-box">
                <!-- Board List -->
                <div class="table">
                    <div class="thead">
                        <div style="margin-left:33px">#</div>
                        <div style="margin-left:200px">Title</div>
                        <div style="margin-left:225px">Name</div>
                        <div style="margin-left:60px">View</div>
                        <div style="margin-left:77px">Date</div>
                    </div>
                    <div class="tbody">
                        <div class="trow">
                            <div th:text="${board.id}">9999</div>
                            <div class="trow__title">
                                <span th:text="${board.title}" style="margin-right: 5px;">this iasasdfasdfasdfasdfasdfasdfs</span>
                                <span class="like-comment">
                                    <span class="trow__like material-icons">favorite</span>
                                    <span th:text="${board.likes}">13</span>
                                    <span class="trow__comment material-icons">textsms</span>
<!--                                    <span th:text="${#lists.size(firstcomments)}">33</span>-->
                                </span>
                            </div>
                            <div th:text="${board.username}">user1232</div>
                            <div th:text="${board.view}">332</div>
                            <div th:text="${board.date}">2010-03-30</div>
                        </div>
                    </div>
                    <div class="content-box">
                        <div class="content" th:text="${board.content}">
                            asdasd<br>adsdsasd<br>asdasd<br>asd<br>asd<br>asd<br>asd<br>asd<br>asd<br>asd<br>asd<br>asd<br>asd<br>asd<br>asd<br>asd<br>asd<br>asd<br>asd<br>
                        </div>
                        <div class="modify-btns" id="modify-btns">
                            <span class="like-btn" th:onclick="|likePost(${board.id})|">
                                <div class="material-icons" th:if="${#lists.contains(board.likedUsers, user)}" style="color:red;">favorite</div>
                                <div class="material-icons"  th:unless="${#lists.contains(board.likedUsers, user)}">favorite</div>
                                <span th:text="${#lists.size(board.likedUsers)}">1233</span>
                            </span>
                            <span><a th:href="@{/board/list}">BACK</a></span>
                            <span th:onclick="|deleteBoard(${board.id})|">DELETE</span>
                            <span class="modify-btn">MODIFY</span>
                        </div>
                        <div class="comment-box" id="comment-box">
                            <div>
                                <span>Comments</span>
<!--                                <span th:text="${#lists.size(firstcomments)}">333</span>-->
                            </div>
                            <form th:action="@{/board/read/firstcomment}" method="post">
                                <input type="hidden" name="boardid" th:value="${board.id}">
                                <textarea name="content"></textarea>
                                <button type="submit">Submit</button>
                            </form>
                            <!-- first comment -->
                            <div class="comment-container">
                                <div class="first-comment-box" th:each="comment : ${board.comments}" th:if="${comment.depth == 0 and comment.boardid == board.id}">
                                    <div class="comment">
                                        <div style="font-weight: bold;" th:text="${comment.username}">user1234</div>
                                        <div style="font-size: 13px;" th:text="${comment.content}">this is a comment</div>
                                        <div style="color: gray;" th:text="${comment.date}">2021.32.32 22:33:33</div>
                                    </div>
                                    <div class="btns">
                                        <div class="reply-btns" th:onclick="|openComment(${comment.id})|">
                                            <span>comments</span>
                                            <span th:text="${#lists.size(comment.secondComments) - 1}">142</span>
                                        </div>
                                        <div class="likes" th:onclick="|likeComment(${comment.id})|">
                                            <span class="material-icons" th:if="${#lists.contains(comment.likedUsers, user)}" style="color:red;">favorite</span>
                                            <span class="material-icons" th:unless="${#lists.contains(comment.likedUsers, user)}">favorite</span>
                                            <span th:text="${#lists.size(comment.likedUsers)}">1231</span>
                                        </div>
                                    </div>

                                    <div class="second-comment-container" th:classappend="${comment.id > 0} ? 'comment'+${comment.id}">
                                        <div class="second-comment-box" th:each="secondcomment : ${board.comments}" th:if="${secondcomment.depth == 1 and secondcomment.boardid == board.id and secondcomment.commentid == comment.id}">
                                            <div class="comment">
                                                <div style="font-weight: bold;" th:text="${secondcomment.username}">user1234</div>
                                                <div style="font-size: 13px;" th:text="${secondcomment.content}">this is a commentthis is a commentthis is a commentthis is a commentthis is a commentthis is a commentthis is a comment</div>
                                                <div style="color: gray;" th:text="${secondcomment.date}">2021.32.32 22:33:33</div>
                                            </div>
                                            <div class="btns">
                                                <div class="likes" th:onclick="|likeSecondComment(${secondcomment.id})|">
                                                    <span class="material-icons" th:if="${#lists.contains(secondcomment.likedUsers, user)}" style="color:red;">favorite</span>
                                                    <span class="material-icons" th:unless="${#lists.contains(secondcomment.likedUsers, user)}">favorite</span>
                                                    <span th:classappend="${comment.id > 0} ? 'like-count'+${secondcomment.id}" th:text="${#lists.size(secondcomment.likedUsers)}">1231</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="reply-container">
                                            <form th:action="@{/board/read/secondcomment}" method="post">
                                                <input type="hidden" name="commentid" th:value="${comment.commentid}">
                                                <input type="hidden" name="boardid" th:value="${comment.boardid}">
                                                <input type="hidden" name="depth" th:value="${comment.depth}">
                                                <textarea name="content"></textarea>
                                                <button type="submit" class="reply-submit-btn">Submit</button>
                                            </form>
                                        </div>
                                        <div class="material-icons close-comment-btn" th:onclick="|closeComment(${comment.id})|">keyboard_double_arrow_up</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- board-form -->
                <div class="board-form__container">
                    <form class="board-form" th:action="@{/board/list}" th:object="${board}" method="post">
                        <input type="hidden" th:field="*{id}">
                        <input type="text" th:field="*{title}" placeholder="Title">
                        <textarea th:field="*{content}" placeholder="Type what you want to say to the world, the world is your oyster :)"></textarea>
                        <div class="btns">
                            <a type="button" class="back-btn">Back</a>
                            <button type="submit">Submit</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Darkening -->
    <div class="darkening">

    </div>

    <script>
    <!--    Deleting Post-->
        function deleteBoard(id) {
    $.ajax({
        url: '/api/board/' + id,
        type: 'DELETE',
        success: function(result) {
            window.location.href = '/board/list';
            }
        });
    }

    </script>
</body>
</html>